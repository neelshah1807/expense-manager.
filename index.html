<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Expense Manager</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f6f8;
    padding: 20px;
}
h2 {
    text-align: center;
}
table {
    width: 100%;
    border-collapse: collapse;
    background: #fff;
    margin-top: 10px;
}
th, td {
    border: 1px solid #000;
    padding: 8px;
    text-align: center;
}
th {
    background: #2c3e50;
    color: #fff;
}
input, button {
    padding: 6px;
}
.form-row {
    margin-bottom: 15px;
    display: flex;
    gap: 10px;
}
.form-row input {
    flex: 1;
}
button {
    background: #27ae60;
    color: #fff;
    border: none;
    cursor: pointer;
}
button:hover {
    background: #219150;
}
.summary {
    margin-top: 15px;
    font-weight: bold;
    text-align: center;
}
.export-btn {
    background: #2980b9;
    margin-top: 10px;
}
.export-btn:hover {
    background: #1f6690;
}
</style>
</head>

<body>

<h2>Expense Manager</h2>

<div class="form-row">
    <input type="text" id="name" placeholder="Name of person">
    <input type="date" id="date">
    <input type="text" id="details" placeholder="Expense details">
    <input type="number" id="amount" placeholder="Amount">
    <input type="number" id="credit" placeholder="Credit">
    <button onclick="addExpense()">Add</button>
</div>

<table id="expenseTableMain">
<thead>
<tr>
    <th>Sr.no</th>
    <th>Name of person</th>
    <th>Date</th>
    <th>Expense details</th>
    <th>Amount</th>
    <th>Credit</th>
</tr>
</thead>
<tbody id="expenseTable"></tbody>
</table>

<button class="export-btn" onclick="exportToExcel()">Export to Excel</button>

<div class="summary">
    Total Expense: ₹ <span id="totalExpense">0</span> |
    Total Credit: ₹ <span id="totalCredit">0</span> |
    Balance: ₹ <span id="balance">0</span>
</div>

<script>
let srNo = 0;
let totalExpense = 0;
let totalCredit = 0;

function addExpense() {
    const name = document.getElementById("name").value.trim();
    const date = document.getElementById("date").value;
    const details = document.getElementById("details").value.trim();
    const amount = Number(document.getElementById("amount").value) || 0;
    const credit = Number(document.getElementById("credit").value) || 0;

    if (!name || !date) {
        alert("Please enter Name and Date");
        return;
    }

    srNo++;

    const table = document.getElementById("expenseTable");
    const row = table.insertRow();

    row.insertCell(0).innerText = srNo;
    row.insertCell(1).innerText = name;
    row.insertCell(2).innerText = date;
    row.insertCell(3).innerText = details;
    row.insertCell(4).innerText = amount;
    row.insertCell(5).innerText = credit;

    totalExpense += amount;
    totalCredit += credit;

    document.getElementById("totalExpense").innerText = totalExpense;
    document.getElementById("totalCredit").innerText = totalCredit;
    document.getElementById("balance").innerText = totalCredit - totalExpense;

    // Clear inputs
    document.getElementById("name").value = "";
    document.getElementById("date").value = "";
    document.getElementById("details").value = "";
    document.getElementById("amount").value = "";
    document.getElementById("credit").value = "";
}

function exportToExcel() {
    const table = document.getElementById("expenseTableMain").outerHTML;

    const excelFile = `
    <html xmlns:o="urn:schemas-microsoft-com:office:office"
          xmlns:x="urn:schemas-microsoft-com:office:excel"
          xmlns="http://www.w3.org/TR/REC-html40">
    <head>
        <meta charset="UTF-8">
        <style>
            table { border-collapse: collapse; }
            th, td { border:1px solid #000; padding:6px; text-align:center; }
            th { background:#dddddd; }
        </style>
    </head>
    <body>
        <h3>Expense Manager Report</h3>
        ${table}
        <br>
        <b>Total Expense:</b> ${totalExpense}<br>
        <b>Total Credit:</b> ${totalCredit}<br>
        <b>Balance:</b> ${totalCredit - totalExpense}
    </body>
    </html>`;

    const blob = new Blob([excelFile], { type: "application/vnd.ms-excel" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "Expense_Manager.xls";
    link.click();
}
</script>

</body>
</html>
